{
	"version": 3,
	"sources": [
		"scope.ts"
	],
	"names": [
		"browser",
		"clone",
		"domObjects",
		"extend",
		"raf",
		"win",
		"Eventable",
		"InteractEvent",
		"InteractStatic",
		"InteractableBase",
		"InteractableSet",
		"defaults",
		"events",
		"interactions",
		"Scope",
		"constructor",
		"id",
		"Math",
		"floor",
		"random",
		"isInitialized",
		"listenerMaps",
		"actions",
		"map",
		"phases",
		"start",
		"move",
		"end",
		"methodDict",
		"phaselessTypes",
		"interactStatic",
		"Interactable",
		"interactables",
		"_win",
		"document",
		"window",
		"documents",
		"_plugins",
		"list",
		"onWindowUnload",
		"event",
		"removeDocument",
		"target",
		"scope",
		"_defaults",
		"set",
		"options",
		"fire",
		"interactable",
		"unset",
		"splice",
		"indexOf",
		"addListeners",
		"push",
		"name",
		"arg",
		"listener",
		"init",
		"initScope",
		"pluginIsInstalled",
		"plugin",
		"usePlugin",
		"install",
		"listeners",
		"before",
		"index",
		"len",
		"length",
		"reduce",
		"acc",
		"otherId",
		"addDocument",
		"doc",
		"getDocIndex",
		"getWindow",
		"add",
		"remove",
		"i",
		"getDocOptions",
		"docIndex",
		"now",
		"Date"
	],
	"mappings": "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",
	"sourcesContent": [
		"/* eslint-disable import/no-named-as-default-member */\nimport browser from '@interactjs/utils/browser'\nimport clone from '@interactjs/utils/clone'\nimport domObjects from '@interactjs/utils/domObjects'\nimport extend from '@interactjs/utils/extend'\nimport raf from '@interactjs/utils/raf'\nimport win from '@interactjs/utils/window'\n\nimport Eventable from './Eventable'\nimport InteractEvent, { PhaseMap } from './InteractEvent'\nimport InteractStatic from './InteractStatic'\nimport InteractableBase from './Interactable'\nimport InteractableSet from './InteractableSet'\nimport defaults from './defaultOptions'\nimport events from './events'\nimport interactions from './interactions'\n\nexport interface SignalArgs {\n  'scope:add-document': DocSignalArg\n  'scope:remove-document': DocSignalArg\n  'interactable:unset': { interactable: InteractableBase }\n  'interactable:set': { interactable: InteractableBase, options: Interact.Options }\n  'interactions:destroy': { interaction: Interact.Interaction }\n}\n\nexport type ListenerName = keyof SignalArgs\n\nexport type ListenerMap = {\n  [P in ListenerName]?: (arg: SignalArgs[P], scope: Scope, signalName: P) => void | boolean\n}\n\ninterface DocSignalArg {\n  doc: Document\n  window: Window\n  scope: Scope\n  options?: { [index: string]: any }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-interface\nexport interface ActionMap { // tslint:disable-line no-empty-interface\n}\n\nexport type ActionName = keyof ActionMap\n\nexport interface Actions {\n  map: ActionMap\n  phases: PhaseMap\n  methodDict: { [P in ActionName]?: string }\n  phaselessTypes: { [type: string]: true }\n}\n\nexport interface Plugin {\n  [key: string]: any\n  id?: string\n  listeners?: ListenerMap\n  before?: string[]\n  install? (scope: Scope, options?: any): void\n}\n\nexport default class Scope {\n  id = `__interact_scope_${Math.floor(Math.random() * 100)}`\n  isInitialized = false\n  listenerMaps: Array<{\n    map: ListenerMap\n    id: string\n  }> = []\n\n  browser = browser\n  defaults = clone(defaults) as typeof defaults\n  Eventable = Eventable\n  actions: Actions = {\n    map: {},\n    phases: {\n      start: true,\n      move: true,\n      end: true,\n    },\n    methodDict: {},\n    phaselessTypes: {},\n  }\n\n  interactStatic: any = new InteractStatic(this)\n  InteractEvent = InteractEvent\n  Interactable!: typeof InteractableBase\n  interactables = new InteractableSet(this)\n\n  // main window\n  _win!: Window\n\n  // main document\n  document!: Document\n\n  // main window\n  window!: Window\n\n  // all documents being listened to\n  documents: Array<{ doc: Document, options: any }> = []\n\n  _plugins: {\n    list: Plugin[]\n    map: { [id: string]: Plugin }\n  } = {\n    list: [],\n    map: {},\n  }\n\n  constructor () {\n    const scope = this\n\n    this.Interactable = class extends InteractableBase {\n      get _defaults () { return scope.defaults }\n\n      set (options: Interact.Options) {\n        super.set(options)\n\n        scope.fire('interactable:set', {\n          options,\n          interactable: this,\n        })\n\n        return this\n      }\n\n      unset () {\n        super.unset()\n        scope.interactables.list.splice(scope.interactables.list.indexOf(this), 1)\n\n        scope.fire('interactable:unset', { interactable: this })\n      }\n    }\n  }\n\n  addListeners (map: ListenerMap, id?: string) {\n    this.listenerMaps.push({ id, map })\n  }\n\n  fire<T extends ListenerName> (name: T, arg: SignalArgs[T]): void | false {\n    for (const { map: { [name]: listener } } of this.listenerMaps) {\n      if (!!listener && listener(arg as any, this, name as never) === false) {\n        return false\n      }\n    }\n  }\n\n  onWindowUnload = (event: BeforeUnloadEvent) => this.removeDocument(event.target as Document)\n\n  init (window: Window) {\n    return this.isInitialized\n      ? this\n      : initScope(this, window)\n  }\n\n  pluginIsInstalled (plugin: Plugin) {\n    return this._plugins.map[plugin.id] || this._plugins.list.indexOf(plugin) !== -1\n  }\n\n  usePlugin (plugin: Plugin, options?: { [key: string]: any }) {\n    if (!this.isInitialized) {\n      return this\n    }\n\n    if (this.pluginIsInstalled(plugin)) {\n      return this\n    }\n\n    if (plugin.id) { this._plugins.map[plugin.id] = plugin }\n    this._plugins.list.push(plugin)\n\n    if (plugin.install) {\n      plugin.install(this, options)\n    }\n\n    if (plugin.listeners && plugin.before) {\n      let index = 0\n      const len = this.listenerMaps.length\n      const before = plugin.before.reduce((acc, id) => {\n        acc[id] = true\n        return acc\n      }, {})\n\n      for (; index < len; index++) {\n        const otherId = this.listenerMaps[index].id\n\n        if (before[otherId]) { break }\n      }\n\n      this.listenerMaps.splice(index, 0, { id: plugin.id, map: plugin.listeners })\n    }\n    else if (plugin.listeners) {\n      this.listenerMaps.push({ id: plugin.id, map: plugin.listeners })\n    }\n\n    return this\n  }\n\n  addDocument (doc: Document, options?: any): void | false {\n    // do nothing if document is already known\n    if (this.getDocIndex(doc) !== -1) { return false }\n\n    const window = win.getWindow(doc)\n\n    options = options ? extend({}, options) : {}\n\n    this.documents.push({ doc, options })\n    this.events.documents.push(doc)\n\n    // don't add an unload event for the main document\n    // so that the page may be cached in browser history\n    if (doc !== this.document) {\n      this.events.add(window, 'unload', this.onWindowUnload)\n    }\n\n    this.fire('scope:add-document', { doc, window, scope: this, options })\n  }\n\n  removeDocument (doc: Document) {\n    const index = this.getDocIndex(doc)\n\n    const window = win.getWindow(doc)\n    const options = this.documents[index].options\n\n    this.events.remove(window, 'unload', this.onWindowUnload)\n\n    this.documents.splice(index, 1)\n    this.events.documents.splice(index, 1)\n\n    this.fire('scope:remove-document', { doc, window, scope: this, options })\n  }\n\n  getDocIndex (doc: Document) {\n    for (let i = 0; i < this.documents.length; i++) {\n      if (this.documents[i].doc === doc) {\n        return i\n      }\n    }\n\n    return -1\n  }\n\n  getDocOptions (doc: Document) {\n    const docIndex = this.getDocIndex(doc)\n\n    return docIndex === -1 ? null : this.documents[docIndex].options\n  }\n\n  now () {\n    return ((this.window as any).Date as typeof Date || Date).now()\n  }\n}\n\nexport function initScope (scope: Scope, window: Window) {\n  scope.isInitialized = true\n  win.init(window)\n  domObjects.init(window)\n  browser.init(window)\n  raf.init(window)\n\n  scope.window = window\n  scope.document = window.document\n\n  scope.usePlugin(interactions)\n  scope.usePlugin(events)\n\n  return scope\n}\n\nexport { Scope }\n"
	]
}